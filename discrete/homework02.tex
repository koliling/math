\documentclass{article}
\usepackage[left=3cm,right=3cm,top=3cm,bottom=3cm]{geometry}
\usepackage{amsmath,amssymb,amsthm,tikz,mathtools}
\usepackage{color}
\usepackage[inline]{enumitem}
\usetikzlibrary{patterns}
\setlength{\parindent}{0mm}
\newcommand{\TODO}[1]{\textcolor{red}{TODO: #1}}

\begin{document}
\title{Discrete Mathematics: Problem Set 2}
\author{Li Ling Ko\\ lko@nd.edu}
\date{\today}
\maketitle

In the problems in this section that merely state an identity without given
a question, the question is always to exhibit a combinatorial proof of the
identity.

\begin{enumerate}[label={\bf Q\arabic*:}]
  \item \it From the binomial theorem we find that for $n\geq1$,
    \[\binom{n}{0}+\binom{n}{2}+\ldots =\binom{n}{1}+\binom{n}{3}+\ldots.\]
    Give a bijective combinatorial proof of this fact. That is, construct
    sets $\mathcal{S}_1$ and $\mathcal{S}_2$ with
    $|\mathcal{S}_1|=\binom{n}{0}+\binom{n}{2}+\ldots$ and
    $|\mathcal{S}_2|=\binom{n}{1}+\binom{n}{3}+\ldots$, and exhibit a
    bijection between $\mathcal{S}_1$ and $\mathcal{S}_2$.

    \begin{proof}
      Let $\mathcal{S}_1$ be the set of all subsets of $\{1,\ldots,n\}$
      of even cardinality, and $\mathcal{S}_2$ the set of all subsets odd
      cardinality. Consider the map
      $f:\mathcal{S}_1\rightarrow\mathcal{S}_2$ defined by
      $f(A)=A\bigtriangleup\{1\}$, where $\bigtriangleup$ denotes symmetric
      difference. Then $f$ is a bijection, thus the formula holds.
    \end{proof}

  \item \it (Parallel summation identity) For $m,n\geq0$,
    \[\sum_{k=0}^n\binom{m+k}{k} =\binom{n+m+1}{n}.\]

    \begin{proof}
      $\binom{n+m+1}{n}$ is the number of subsets $\mathcal{S}$ of
      $A=\{a_1,\ldots,a_n,b_1,\ldots,b_m,c\}$ of size $n$. For
      $k\in\{0,\ldots,n\}$, denote by $\mathcal{S}_{k}$ the set of subsets
      of $A$ of size $n$ such that all elements in $\{a_1,\ldots,a_k\}$
      appear in the subset but $a_{k+1}$ does not. Then
      $|\mathcal{S}_k|=\binom{m+n-k}{n-k}$. Also, $\mathcal{S}$ is the
      disjoint union of $\mathcal{S}_0,\ldots,\mathcal{S}_n$. Thus the
      parallel summation identity holds.
    \end{proof}

  \item \it Derive the parallel summation identity from the upper summation
    identity, using an early, extremely simple binomial coefficient
    identity.

    \begin{proof}
      \begin{align*}
        \binom{n+m+1}{n} &=\binom{n+m+1}{m+1} &(\text{symmetry identity}) \\
        &=\binom{m}{m}+\binom{m+1}{m}+\ldots+\binom{m+n}{m} &(\text{
          upper summation identity}) \\
        &=\binom{m}{0}+\binom{m+1}{1}+\ldots+\binom{m+n}{n} &(\text{
          symmetry identity}) \\
        &=\sum_{k=0}^n\binom{m+k}{k}.
      \end{align*}
    \end{proof}

  \item \it (Cancellation, or committee-chair identity) For $n\geq k\geq1$,
    \[\binom{n}{k} =\frac{n}{k}\binom{n-1}{k-1}\;\; \text{or}\;\;
    k\binom{n}{k}=n\binom{n-1}{k-1}.\]

    \begin{proof}
      We ask how many ways there are to choose $k$
      committee members from $n$ people, and electing 1 of the $k$ members
      to be the committee chair. On the left hand side, we first choose $k$
      members from $n$ people, and for each of these choices, we elect
      one of the $k$ members to be the committee chair. Thus we get
      $k\binom{n}{k}$ ways to answer the question. On the right hand side,
      we first choose the committee-chair from one of the $n$ people. From
      the remaining $n-1$ people, we pick $k-1$ to be in the committee, but
      none of these $k-1$ committee members are chair. This gives us
      $n\binom{n-1}{k-1}$ ways to answer the question. Equating both
      solutions give us
      \[k\binom{n}{k}=n\binom{n-1}{k-1}.\]
    \end{proof}

  \item \it (Committee-subcommittee identity) For $n\geq k\geq r\geq0$,
    \[\binom{k}{r}\binom{n}{k} = \binom{n}{r}\binom{n-r}{k-r}.\]

    \begin{proof}
      We ask how many ways there are to choose $k$
      committee members from $n$ people, and within these $k$ members, to
      choose $r$ of them to be subcommittee members. On the left hand
      side, we first choose $k$ members from $n$ people, and for each of
      these choices, we choose $r$ of them to be in the subcommittee.
      Thus we get $\binom{k}{r}\binom{n}{k}$ ways to answer the
      question. On the right hand side, we first choose $r$ subcommittee
      members from one of the $n$ people. From the remaining $n-r$ people,
      we pick $k-r$ to be in the committee, but none of these $k-r$
      committee members are in the subcommittee. This gives us
      $\binom{n}{r}\binom{n-1}{k-1}$ ways to answer the question. Equating
      both solutions give us
      \[\binom{k}{r}\binom{n}{k}=\binom{n}{r}\binom{n-1}{k-1}.\]
    \end{proof}

  \item \it (Vandermonde's identity) For $m,n,r\geq0$,
    \[\binom{m+n}{r} =\sum_{k=0}^r\binom{m}{k}\binom{n}{r-k}.\]

    \begin{proof}
      We ask how many ways there are to choose $r$ elements from a set with
      $m+n$ elements. On the left hand side, we know that the number of
      ways is $\binom{m+n}{r}$. On the right hand side, we let the set $S$ of
      $m+n$ elements be the disjoint union of sets $A$ with $m$ elements
      and set $B$ with $n$ elements. Then for case $k\in\{0,\ldots,r\}$, to
      form a subset of $S$ with $r$ elements, we first choose $k$ elements
      from $A$ before choosing $r-k$ elements from $B$. Each of these cases
      give us $\binom{m}{k}\binom{n}{r-k}$ subsets. This gives the total
      number of ways to be $\sum_{k=0}^r\binom{m}{k}\binom{n}{r-k}$.
    \end{proof}

  \item \it (Binomial theorem for falling powers) With
    $(x)_k=x(x-1)\ldots(x-k+1)$,
    \[(x+y)_n =\sum_{k=0}^n\binom{n}{k}(x)_k(y)_{n-k}.\]
    Here $x$ and $y$ are (complex) variables, and $n\geq0$.

    \begin{proof}
      We first prove for the case where $x,y\in\mathbb{N}$ and $x,y\geq n$.
      Then the left hand side computes the number of ways to draw $n$
      objects from a set of size $x+y$, and arrange them in order. This is
      the same as asking how many ordered subsets of size $n$ we can get
      from the disjoint union $S=A\sqcup B$, where $A=\{a_1,\ldots,a_x\}$
      and $B=\{b_1,\ldots,b_y\}$. Let $\mathcal{S}$ denote the set of
      ordered subsets, and let $\mathcal{S}_k$ denote the set of ordered
      subsets where $k$ elements come from set $A$ and $n-k$ elements come
      from set $B$. Then $\mathcal{S}$ is the disjoint union
      $\mathcal{S}=\mathcal{S}_0\sqcup\ldots\sqcup\mathcal{S}_n$. Thus
      \[(x+y)_n =|\mathcal{S}|
      =|\mathcal{S}_0|\sqcup\ldots\sqcup|\mathcal{S}_n|.\]

      Now for $k=0,\ldots,n$, to compute $|\mathcal{S}_k|$, we first
      consider determining the $k$ positions amongst positions $1,\ldots,n$
      that should contain elements from set $A$; there are $\binom{n}{k}$
      such positions. For each such position, we consider how we can choose
      $k$ elements from set $A$ and order them within the chosen positions;
      there are $(x)_k$ such possibilities. Similarly, for each such
      possibility, we consider how we can choose $n-k$ elements from set
      $B$ and order them within the remaining $n-k$ positions; there are
      $(y)_{n-k}$ such possibilities. Thus,
      $|\mathcal{S}_k|=\binom{n}{k}(x)_k(y)_{n-k}$. Summarizing, we have
      \begin{align*}
        (x+y)_n &=|\mathcal{S}| \\
        &=|\mathcal{S}_0|\sqcup\ldots\sqcup|\mathcal{S}_n| \\
        &=\binom{n}{0}(x)_0(y)_n +\ldots +\binom{n}{n}(x)_n(y)_0. \\
        &=\sum_{k=0}^n\binom{n}{k}(x)_k(y)_{n-k}, \\
      \end{align*}
      so the assertion in the question holds for all $x,y\in\mathbb{N}$,
      where $x,y\geq n\in\mathbb{N}$. \\

      Now we generalize our solution to the case where $x,y\in\mathbb{C}$.
      Denote \[f(x,y):=(x+y)_n-\sum_{k=0}^n\binom{n}{k}(x)_k(y)_{n-k}.\]
      Notice that $f(x,y)\in\mathbb{C}[x,y]$, thus we can write
      \[f(x,y)= g_m(y)x^m+\ldots+g_1(y)x+g_0(y),\]
      for some $m\in\mathbb{N}$, and
      $g_m(y),\ldots,g_0(y)\in\mathbb{C}[y]$. Earlier, we proved that
      $f(x,y)=0$ for all $x,y\in\mathbb{N}$ and $x,y\geq n$. Thus, at
      $y=n$, the polynomial
      \[f(x,n)= g_m(n)x^m+\ldots+g_1(n)x+g_0(n) \in\mathbb{C}[x]\]
      has infinite solutions $x=n,n+1,n+1,\ldots$. Thus from Principle 7.6,
      the coefficients $g_m(n),\ldots,g_0(n)$ must be identically 0.
      Repeating the argument at $y=n+1,n+2,\ldots$, we get
      \[g_m(n+i)=\ldots=g_0(n+i)=0\]
      for all $i\in\mathbb{N}$. In other words, for each
      $k\in\{0,\ldots,m\}$, the polynomial $g_k(y)\in\mathbb{C}[y]$ has
      infinite solutions $n,n+1,n+2,\ldots$. Applying Principle 7.6 again,
      the polynomial $g_k(y)$ must be identically 0. Thus, $f(x,y)=0$ for
      all $x,y\in\mathbb{C}$, so the assertion in the question holds in
      the general case where $x,y\in\mathbb{C}$.
    \end{proof}

  \item \it Derive the binomial theorem for falling powers from
    Vandermonde's identity.

    \begin{proof}
      We are assuming that $x,y\in\mathbb{N}$ and $x,y\geq n$. Then we have
      \begin{align*}
        (x+y)_n &=n!\binom{x+y}{n} \\
        &=\sum_{k=0}^nn!\binom{x}{k}\binom{y}{n-k} &(\text{Vandermonde's
          identity}) \\
        &=\sum_{k=0}^nn!\frac{(x)_k}{k!}\frac{(y)_{n-k}}{(n-k)!} \\
        &=\sum_{k=0}^n\frac{n!}{k!(n-k)!}(x)_k(y)_{n-k} \\
        &=\sum_{k=0}^n\binom{n}{k}(x)_k(y)_{n-k}. \\
      \end{align*}
    \end{proof}

  \item \it (Binomial theorem for rising powers) Using the binomial theorem
    for falling powers, derive the following. With
    $x^{(k)}:=x(x+1)\ldots(x+k-1)$,
    \[(x+y)^{(n)} =\sum_{k=0}^n\binom{n}{k}x^{(k)}y^{(n-k)}.\]
    Here again $x$ and $y$ are complex variables, and $n\geq0$.

    \begin{proof}
      First observe that given $z\in\mathbb{C}$ and $k\in\mathbb{N}$, we
      have
      \begin{align*}
        (-z)_{k} &=(-z)(-z-1)\ldots(-z-k+1) \\
        &=(-1)^kz(z+1)\ldots(z+k-1) \\
        &=(-1)^kz^{(k)}.
      \end{align*}
      Rearranging, we also get $z^{(k)}=(-1)^k(-z)_k$.  Note that since the
      binomial theorem for falling powers hold for variables in
      $\mathbb{C}$, these equations also hold for all $z\in\mathbb{C}$.

      Thus we have
      \begin{align*}
        (x+y)^{(n)} &=(-1)^n(-x-y)_{n} \\
        &=(-1)^n \sum_{k=0}^{n} \binom{n}{k}(-x)_{k}(-y)_{n-k}
          &(\text{Binomial theorem for falling powers}) \\
        &=(-1)^n \sum_{k=0}^{n} \binom{n}{k} (-1)^kx^{(k)}
          (-1)^{n-k}y^{(n-k)} \\
        &=(-1)^n \sum_{k=0}^{n} \binom{n}{k} (-1)^nx^{(k)} y^{(n-k)} \\
        &=(-1)^{2n} \sum_{k=0}^{n} \binom{n}{k} x^{(k)} y^{(n-k)} \\
        &=\sum_{k=0}^{n} \binom{n}{k} x^{(k)} y^{(n-k)}. \\
      \end{align*}
    \end{proof}

  \item \it (Hexagon identity) For $n\geq1$ and $m\geq0$,
    \[\binom{n-1}{m-1}\binom{n}{m+1}\binom{n+1}{m}
      =\binom{n}{m-1}\binom{n-1}{m}\binom{n+1}{m+1}.\]
    Note that an algebraic proof of this identity is very easy. You will
    probably find a combinatorial proof very hard! To see why this is
    called the hexagon identity, mark the terms involved in Pascal's
    triangle.

    \begin{proof}
      On the left hand side, we are counting the number of ways of choosing
      $m-1$ elements from the set $A=\{a_1,\ldots,a_{n-1}\}$, followed by
      choosing $m+1$ elements from the set $B=\{b_1,\ldots,b_{n}\}$,
      followed by choosing $m$ elements from the set
      $C=\{c_1,\ldots,c_{n+1}\}$. The choices are made independently, and
      the ordering of the chosen elements does not matter. \\

      To get the formula on the right hand side, consider moving the last
      element from set $B$ and the last element from set $C$ into set $A$.
      Thus we have the new sets
      \begin{align*}
        A' &=\{a_1,\ldots,a_{n-1},b_n,c_{n+1}\}, \\
        B' &=\{b_1,\ldots,b_{n-1}\}, \\
        C' &=\{c_1,\ldots,c_{n}\}. \\
      \end{align*}
      So in order to get the same possible subsets of $A\sqcup B\sqcup C$
      as on the left hand side, we must now choose an extra two elements
      from set $A'$,
    \end{proof}
\end{enumerate}
\end{document}
