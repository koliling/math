\documentclass{article}
\usepackage[left=3cm,right=3cm,top=3cm,bottom=3cm]{geometry}
\usepackage{amsmath,amssymb,amsthm,tikz,mathtools}
\usepackage{color}
\usepackage[inline]{enumitem}
\usetikzlibrary{patterns}
\setlength{\parindent}{0mm}
\newcommand{\TODO}[1]{\textcolor{red}{TODO: #1}}

\begin{document}
\title{Discrete Mathematics: Problem Set 3}
\author{Li Ling Ko\\ lko@nd.edu}
\date{\today}
\maketitle

\begin{enumerate}[label={\bf Q\arabic*:}]
  \item \it \textbf{Section 15 Problem 5:}
    \begin{proof}
      Let $F_k(n)$ be the number of partitions of $[n]$ into $k$ blocks,
      each containing at least two elements. Find a formula for $F_k(n)$ in
      terms of Stirling numbers of the second kind.

      \begin{proof}
        We apply the inclusion-exclusion theorem to get our formula.
        Let $\mathcal{S}_k(n)$ denote the set of partitions of $[n]$ into
        $k$ non-empty blocks, and given $I\subseteq[n]$, let
        $\mathcal{S}_{k,I}(n)\subseteq \mathcal{S}_k(n)$ denote the set of
        these partitions where for each $i\in I$, the $i$-th element is
        isloated. Observe that
        \begin{align*}
          \mathcal{S}_{k,I}(n) &=\bigcap_{i\in I} \mathcal{S}_{k,\{i\}}(n),\\
          |\mathcal{S}_{k,I}(n)| &=
            \begin{Bmatrix}n-|I|\\k-|I|\end{Bmatrix}.\\
        \end{align*}

        Then,
        \begin{align*}
          F_k(n) &=|\mathcal{S}_k(n)| -\left|\bigcup_{i=1}^n
            \mathcal{S}_{k,\{i\}}(n)\right|\\
          &=\begin{Bmatrix}n\\k\\\end{Bmatrix} -\left|\bigcup_{i=1}^n
            \mathcal{S}_{k,\{i\}}(n)\right|\\
          &=\begin{Bmatrix}n\\k\\\end{Bmatrix}
            -\sum_{I\neq\emptyset\subseteq[k]} (-1)^{|I|-1}
            \left|\bigcap_{i\in I} \mathcal{S}_{k,\{i\}}(n)\right|
            &(\text{by inclusion-exclusion})\\
          &=\begin{Bmatrix}n\\k\\\end{Bmatrix}
            -\sum_{I\neq\emptyset\subseteq[k]} (-1)^{|I|-1}
            \left|\mathcal{S}_{k,I}(n)\right| &(\text{by above})\\
          &=\begin{Bmatrix}n\\k\\\end{Bmatrix}
            -\sum_{I\neq\emptyset\subseteq[k]} (-1)^{|I|-1}
            \begin{Bmatrix}n-|I|\\k-|I|\end{Bmatrix}\\
          &=\begin{Bmatrix}n\\k\\\end{Bmatrix}
            -\sum_{i=1}^n \sum_{I\subseteq[k],|I|=i} (-1)^{i-1}
            \begin{Bmatrix}n-i\\k-i\end{Bmatrix}\\
          &=\begin{Bmatrix}n\\k\\\end{Bmatrix}
            -\sum_{i=1}^n \binom{k}{i} (-1)^{i-1}
            \begin{Bmatrix}n-i\\k-i\end{Bmatrix}.\\
        \end{align*}
      \end{proof}
    \end{proof}

  \item \it \textbf{Section 22 Problem 1:} A hotel corridor has $n$ rooms
    in a row, numbered 1 through $n$. The rooms are to be painted, each one
    either red, or white, or blue, subject to the condition that a red room
    can't be immediately adjacent to a blue room. Let $p_n$ be the number
    of different ways to paint the rooms. Find a recurrence for $p_n$, and
    use generating functions to find an explicit expression for $p_n$.

    \begin{proof}
      Let $\mathcal{S}_n\subset\{R,W,B\}^n$ denote the number of such
      paintings, and for each $i\in\{0,\ldots,n\}$, let
      $\mathcal{S}_n(i)\subset\mathcal{S}_n$ denote the paintings where $i$
      is the number of the largest room painted white, with
      $\mathcal{S}_n(0)$ denoting the case where no door is painted white.
      Then
      \[\mathcal{S}_n =\bigsqcup_{i=0}^n \mathcal{S}_n(i).\]

      Also, observe that if $i$ is number of the largest room colored
      white, then the rooms numbered $i+1\ldots n$ must be either all
      colored red or all colored blue. Then
      \[|\mathcal{S}_n(0)|=|\mathcal{S}_n(1)|=2,\]
      and for for $i\in\{2,\ldots,n-1\}$,
      \[|\mathcal{S}_n(i)| =2p_{i-1},\]
      and finally,
      \[|\mathcal{S}_n(n)| =p_{n-1}.\]

      Then using the convention that $p_0=1$, we have the following
      recurrence relation:
      \begin{align*}
        p_n &=|\mathcal{S}_n|\\
        &=\left|\bigsqcup_{i=0}^n \mathcal{S}_n(i)\right|\\
        &=\sum_{i=0}^n|\mathcal{S}_n(i)|\\
        &=2+2+\sum_{i=2}^{n-1} 2p_{i-1}+p_{n-1}\\
        &=4+2p_1+\ldots+2p_{n-2}+p_{n-1}\\
        &=2+2p_0+\ldots+2p_{n-2}+p_{n-1}.\\
      \end{align*}

      So the generating function $P(x)$ of the sequence $p_n$ is
      \begin{align*}
        P(x) &=p_0 +p_1x +p_2x^2+\ldots\\
          &=1\\
          &\;\;\;+(2+p_0)x\\
          &\;\;\;+(2+2p_0+p_1)x^2\\
          &\;\;\;+(2+2p_0+2p_1+p_2)x^3\\
          &\;\;\;+\ldots\\
        &=1+x(p_0+p_1x+p_2x^2+\ldots)\\
          &\;\;\;+2x(1+x+x^2+\ldots)\\
          &\;\;\;+2p_0x^2(1+x+x^2+\ldots)\\
          &\;\;\;+2p_1x^3(1+x+x^2+\ldots)\\
          &\;\;\;+\ldots\\
        &=1+xP(x) +\frac{2x+2x^2(p_0+p_1x+p_2x^2+\ldots)}{1-x}\\
        &=1+xP(x) +\frac{2x+2x^2P(x)}{1-x}.\\
      \end{align*}

      Rearranging to solve for $P(x)$, we get
      \begin{align*}
        P(x) &=-\frac{x+1}{x^2+2x-1}\\
        &=-\frac{x+1}{(x+1+\sqrt{2})(x+1-\sqrt{2})}.\\
      \end{align*}

      Solving for partial fractions, we get
      \begin{align*}
        P(x) &=-\frac{x+1}{(x+1+\sqrt{2})(x+1-\sqrt{2})}\\
        &=\frac{(1-\sqrt{2})/2}{1-(1-\sqrt{2})x}
          +\frac{(1+\sqrt{2})/2}{1-(1+\sqrt{2})x}\\
        &=\frac{1-\sqrt{2}}{2} \sum_{n=0}^\infty
          \left(1-\sqrt{2}\right)^nx^n +\frac{1-\sqrt{2}}{2}
          \sum_{n=0}^\infty \left(1+\sqrt{2}\right)^nx^n\\
        &=\frac{1}{2} \sum_{n=0}^\infty \left[\left(1-\sqrt{2}\right)^{n+1}
        +\left(1+\sqrt{2}\right)^{n+1}\right] x^n.\\
      \end{align*}

      Comparing coefficients, we get
      \[p_n =\frac{1}{2} \left[\left(1-\sqrt{2}\right)^{n+1}
        +\left(1+\sqrt{2}\right)^{n+1}\right].\]
    \end{proof}
\end{enumerate}
\end{document}
